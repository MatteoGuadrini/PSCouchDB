

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Permission &mdash; PSCouchDB  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Server operation" href="server.html" />
    <link rel="prev" title="Setup" href="config.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> PSCouchDB
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html">Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html#nodes">Nodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="config.html#configuration">Configuration</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Permission</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#admin-party">Admin Party</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-admin-user">Create Admin user</a></li>
<li class="toctree-l2"><a class="reference internal" href="#limit-read-access">Limit read access</a></li>
<li class="toctree-l2"><a class="reference internal" href="#limit-write-access">Limit write access</a></li>
<li class="toctree-l2"><a class="reference internal" href="#revoke-database-permissions">Revoke database permissions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#remove-an-admin">Remove an admin</a></li>
<li class="toctree-l2"><a class="reference internal" href="#remove-a-user">Remove a user</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reset-user-password">Reset user password</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reset-admin-password">Reset admin password</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="server.html">Server operation</a></li>
<li class="toctree-l1"><a class="reference internal" href="server.html#replication">Replication</a></li>
<li class="toctree-l1"><a class="reference internal" href="auth.html">Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="databases.html">Databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="documents.html">Documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="documents.html#query">Query</a></li>
<li class="toctree-l1"><a class="reference internal" href="ddoc.html">Design documents</a></li>
<li class="toctree-l1"><a class="reference internal" href="cmdlets.html">Cmdlets and aliases</a></li>
<li class="toctree-l1"><a class="reference internal" href="classes.html">Classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="uses.html">Real uses</a></li>
<li class="toctree-l1"><a class="reference internal" href="support.html">Support</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PSCouchDB</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Permission</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/permission.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="permission">
<h1>Permission<a class="headerlink" href="#permission" title="Permalink to this headline">¶</a></h1>
<div class="section" id="admin-party">
<h2>Admin Party<a class="headerlink" href="#admin-party" title="Permalink to this headline">¶</a></h2>
<p>When you start out fresh, CouchDB allows any request to be made by anyone. Create a database and delete some documents? Same deal. CouchDB calls this the Admin Party. Everybody has privileges to do anything.</p>
<p>This is very nice for testing enviroment, but anyone could delete documents or the whole database. By default, CouchDB, will listen only on your loopback network interface (127.0.0.1 or localhost) and thus only you will be able to make requests to CouchDB, nobody else. But when it is necessary to expose the service on public ip, you will want to think about restricting access.</p>
<p>CouchDB has the idea of an admin user (for example, an administrator, a super user, or root) that is allowed to do anything to a CouchDB installation. By default, everybody is an admin.</p>
<p>To restrict permissions, one or more administrators must be created.</p>
</div>
<div class="section" id="create-admin-user">
<h2>Create Admin user<a class="headerlink" href="#create-admin-user" title="Permalink to this headline">¶</a></h2>
<p>Admin Party allows any user to perform any database operation.
This could be perfect for application development or on a test machine, but for production it would create many problems.
To solve this problem, just create an admin user. At this point the admin user can create/modify/delete documents from the database.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">If the password is not specified, it will be prompted. For example, <code class="docutils literal notranslate"><span class="pre">-Authorization</span> <span class="pre">admin</span></code> will ask you to write the password at the prompt.
The password has the format <strong>*</strong>.</p>
</div>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$password</span> <span class="p">=</span> <span class="s2">&quot;password&quot;</span> <span class="p">|</span> <span class="nb">ConvertTo-SecureString</span> <span class="n">-AsPlainText</span> <span class="n">-Force</span>
<span class="nb">New-CouchDBAdmin</span> <span class="n">-Userid</span> <span class="n">admin</span> <span class="n">-Password</span> <span class="nv">$password</span>
</pre></div>
</div>
<p>Naturally, all reading requests can be made without user and password.</p>
</div>
<div class="section" id="limit-read-access">
<h2>Limit read access<a class="headerlink" href="#limit-read-access" title="Permalink to this headline">¶</a></h2>
<p>To protect a database from reading requests, you must first create a user used for this purpose.</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$password</span> <span class="p">=</span> <span class="s2">&quot;read_password&quot;</span> <span class="p">|</span> <span class="nb">ConvertTo-SecureString</span> <span class="n">-AsPlainText</span> <span class="n">-Force</span>
<span class="nb">New-CouchDBUser</span> <span class="n">-Userid</span> <span class="n">read_user</span> <span class="n">-Password</span> <span class="nv">$password</span> <span class="n">-Authorization</span> <span class="s2">&quot;admin:password&quot;</span>
</pre></div>
</div>
<p>And then enable it to the server.</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="n">Grant-CouchDBDatabasePermission</span> <span class="n">-Database</span> <span class="n">test</span> <span class="n">-ReaderUser</span> <span class="n">read_user</span> <span class="n">-Authorization</span> <span class="s2">&quot;admin:password&quot;</span>
</pre></div>
</div>
<p>Let’s check the permissions now.</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Get-CouchDBDatabaseSecurity</span> <span class="n">-Database</span> <span class="n">test</span> <span class="n">-Authorization</span> <span class="s2">&quot;read_user:read_password&quot;</span>
<span class="nb">Get-CouchDBDatabase</span> <span class="n">-Database</span> <span class="n">test</span> <span class="n">-Authorization</span> <span class="s2">&quot;read_user:read_password&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="limit-write-access">
<h2>Limit write access<a class="headerlink" href="#limit-write-access" title="Permalink to this headline">¶</a></h2>
<p>If you want to limit a single database with different admin user for reading and writing, use this cmdlet:</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$password</span> <span class="p">=</span> <span class="s2">&quot;password&quot;</span> <span class="p">|</span> <span class="nb">ConvertTo-SecureString</span> <span class="n">-AsPlainText</span> <span class="n">-Force</span>
<span class="nb">New-CouchDBUser</span> <span class="n">-Userid</span> <span class="n">other_admin</span> <span class="n">-Password</span> <span class="nv">$password</span> <span class="n">-Authorization</span> <span class="s2">&quot;admin:password&quot;</span>
<span class="n">Grant-CouchDBDatabasePermission</span> <span class="n">-Database</span> <span class="n">test</span> <span class="n">-AdminUser</span> <span class="n">other_admin</span> <span class="n">-Authorization</span> <span class="s2">&quot;admin:password&quot;</span>
<span class="nb">Get-CouchDBDatabase</span> <span class="n">-Database</span> <span class="n">test</span> <span class="n">-Authorization</span> <span class="s2">&quot;other_admin:password&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="revoke-database-permissions">
<h2>Revoke database permissions<a class="headerlink" href="#revoke-database-permissions" title="Permalink to this headline">¶</a></h2>
<p>To remove permissions from one database, run this cmdlet:</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="n">Revoke-CouchDBDatabasePermission</span> <span class="n">-Database</span> <span class="n">test</span> <span class="n">-Authorization</span> <span class="s2">&quot;admin:password&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="remove-an-admin">
<h2>Remove an admin<a class="headerlink" href="#remove-an-admin" title="Permalink to this headline">¶</a></h2>
<p>To remove an administrative user, run:</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nb">Remove-CouchDBAdmin</span> <span class="n">-Userid</span> <span class="n">admin</span> <span class="n">-Authorization</span> <span class="s2">&quot;admin:password&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="remove-a-user">
<h2>Remove a user<a class="headerlink" href="#remove-a-user" title="Permalink to this headline">¶</a></h2>
<p>To remove a simple user, run:</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$user</span> <span class="p">=</span> <span class="nb">Get-CouchDBUser</span> <span class="n">-Userid</span> <span class="n">read_user</span> <span class="p">|</span> <span class="nb">Select-Object</span> <span class="n">_id</span><span class="p">,</span><span class="n">_rev</span>
<span class="nb">Remove-CouchDBUser</span> <span class="n">-Userid</span> <span class="nv">$user</span><span class="p">.</span><span class="n">_id</span> <span class="n">-Revision</span> <span class="nv">$user</span><span class="p">.</span><span class="n">_rev</span> <span class="n">-Authorization</span> <span class="s2">&quot;admin:password&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="reset-user-password">
<h2>Reset user password<a class="headerlink" href="#reset-user-password" title="Permalink to this headline">¶</a></h2>
<p>To modify o reset password of a user.</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$password</span> <span class="p">=</span> <span class="s2">&quot;new_password&quot;</span> <span class="p">|</span> <span class="nb">ConvertTo-SecureString</span> <span class="n">-AsPlainText</span> <span class="n">-Force</span>
<span class="nb">Set-CouchDBUser</span> <span class="n">-Userid</span> <span class="n">read_user</span> <span class="n">-Password</span> <span class="nv">$password</span> <span class="n">-Revision</span> <span class="s2">&quot;2-4705a219cdcca7c72aac4f623f5c46a8&quot;</span> <span class="n">-Authorization</span> <span class="s2">&quot;admin:password&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="reset-admin-password">
<h2>Reset admin password<a class="headerlink" href="#reset-admin-password" title="Permalink to this headline">¶</a></h2>
<p>To modify o reset password of an admin.</p>
<div class="highlight-powershell notranslate"><div class="highlight"><pre><span></span><span class="nv">$password</span> <span class="p">=</span> <span class="s2">&quot;new_password&quot;</span> <span class="p">|</span> <span class="nb">ConvertTo-SecureString</span> <span class="n">-AsPlainText</span> <span class="n">-Force</span>
<span class="nb">Set-CouchDBAdmin</span> <span class="n">-Userid</span> <span class="n">test_user</span> <span class="n">-Password</span> <span class="nv">$password</span> <span class="n">-Authorization</span> <span class="s2">&quot;admin:password&quot;</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="server.html" class="btn btn-neutral float-right" title="Server operation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="config.html" class="btn btn-neutral" title="Setup" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Matteo Guadrini

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>  

	<style>
		/* Sidebar header (and topbar for mobile) */
		.wy-side-nav-search, .wy-nav-top {
			background: #1B2C3E;
		}
		/* Sidebar */
		.wy-nav-side {
			background: #2A425E;
		}
	</style>



</body>
</html>